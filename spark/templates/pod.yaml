apiVersion: v1
kind: Pod
metadata:
  name: spark
spec:
  restartPolicy: Never
  # https://kubernetes.io/docs/tasks/configure-pod-container/security-context/
  # https://github.com/torvalds/linux/blob/master/include/uapi/linux/capability.h
  securityContext:
    runAsUser: 0
    runAsGroup: 0
  containers:
  - name: spark
    image: python:3.13.10-alpine3.22
    imagePullPolicy: IfNotPresent
    securityContext:
      runAsUser: 0
      runAsGroup: 0
      capabilities:
        add: ["SYS_ADMIN"]
    command: ["python3","-u","-c"]
    args:
    - |
      {{- include "spark.py" . | nindent 6 }}
    volumeMounts:
    - mountPath: /spark
      name: vol-host
      readOnly: false
  volumes:
  - name: vol-host
    hostPath:
      path: /
      type: Directory
